{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}KiKi - Korean Fashion{% endblock %}</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #ff6b9d;
            --secondary-color: #4ecdc4;
            --accent-color: #ffe66d;
            --dark-color: #2c3e50;
            --light-color: #f8f9fa;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            line-height: 1.6;
        }
        
        .navbar {
            background-color: #ff6b9d !important;
            padding: 0;
            min-height: auto;
            transition: transform 0.3s ease-in-out;
            will-change: transform;
        }
        
        .navbar.nav-up {
            transform: translateY(-100%);
        }
        
        .navbar .container {
            padding: 0;
        }
        .navbar-brand {
            width:80px;
        }
        .navbar-brand img {
            width: auto;
            height: 70px;
        }

        .nav-link {
            color: white !important;
            font-weight: 500;
            font-weight: bold;
            padding: 0.3rem 0.8rem;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover:not(.cart-link) {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            transform: translateY(-2px);
        }
        .navbar-toggler-icon {
            display: inline-block;
            width: 0.8em;
            height: 0.8em;
            vertical-align: middle;
            background-image: var(--bs-navbar-toggler-icon-bg);
            background-repeat: no-repeat;
            background-position: center;
            background-size: 100%;
        }


        
        /* Dropdown hover effects - only on desktop */
        @media (min-width: 992px) {
            .nav-item.dropdown:hover .dropdown-menu:not(.hamburger-dropdown) {
                display: block;
                opacity: 1;
                transform: translateY(0);
            }
            
            .dropdown-menu:not(.hamburger-dropdown):hover {
                display: block;
                opacity: 1;
                transform: translateY(0);
            }
            
            /* Keep dropdown visible when hovering over dropdown items */
            .nav-item.dropdown:hover .dropdown-menu:not(.hamburger-dropdown),
            .dropdown-menu:not(.hamburger-dropdown):hover {
                display: block !important;
                opacity: 1 !important;
                transform: translateY(0) !important;
            }
            .hamburger-menu {
                background-color: #e55a8a;
                border: none;
                padding: 10px 15px;
                border-radius: 50px;
                color: white;
                font-weight: bold;
                font-size: 14px;
                margin-right: 14px;
                transition: all 0.3s ease;
                cursor: pointer;
        }
        }
        
        .dropdown-menu:not(.hamburger-dropdown) {
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }
        
        /* Show dropdown when Bootstrap adds 'show' class */
        .dropdown-menu.show:not(.hamburger-dropdown) {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Mobile/Tablet specific dropdown styles */
        @media (max-width: 991px) {
            .dropdown-menu:not(.hamburger-dropdown) {
                min-width: 300px;
                background-color: white;
                margin-top: 5px;
            }
            
            .nav-item.dropdown {
                position: relative;
            }
            
            .dropdown-menu.show:not(.hamburger-dropdown) {
                display: block;
                opacity: 1;
                transform: translateY(0);
            }
             .hamburger-menu {
                background-color: #e55a8a;
                border: none;
                padding: 10px 15px;
                border-radius: 8px;
                color: white;
                font-size: 14px;
                margin-right: 300px;
                transition: all 0.3s ease;
                cursor: pointer;
            }
            .dropdown-menu[data-bs-popper] {
                top: 128%;
                right: -3%;
                margin-top: var(--bs-dropdown-spacer);
            }
        }
        
        .dropdown-item {
            transition: all 0.3s ease;
            padding: 10px 20px;
            border-radius: 5px;
            margin: 0px -1px;
        }
        
        .dropdown-item:hover {
            background-color: rgba(255, 107, 157, 0.1);
            color: var(--primary-color);
            transform: translateX(-6px);
        }
        
        .dropdown-item i {
            transition: all 0.3s ease;
        }
        
        .dropdown-item:hover i {
            transform: scale(1.2);
            color: var(--primary-color);
        }
        
        .hamburger-menu:hover {
            background-color: #d1477a;
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(225, 90, 138, 0.3);
        }
        
        .hamburger-dropdown {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            min-width: 660px;
        }
        
        .hamburger-dropdown .dropdown-item {
            padding: 10px 15px;
            transition: all 0.3s ease;
            border: none;
        }
        
        .hamburger-dropdown .dropdown-item:hover {
            background-color: rgba(255, 107, 157, 0.1);
            color: var(--primary-color);
        }
        
        .hamburger-dropdown .dropdown-item i {
            width: 20px;
            text-align: center;
        }
        
        /* Hamburger submenu styles */
        .dropdown-submenu {
            position: relative;
        }
        
        .dropdown-submenu .dropdown-toggle::after {
            content: "▶";
            border: none;
            font-size: 10px;
            color: #666;
            margin-left: auto;
            float: right;
            margin-top: 2px;
        }
        
        .hamburger-products-mega {
            position: absolute !important;
            left: 0% !important;
            top: 50px !important;
            min-width: 600px;
            background-color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 20px;
            z-index: 1070 !important;
            display: none;
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.3s ease;
        }
        
        /* Mobile: Show submenu below instead of to the side */
        @media (max-width: 768px) {
            .navbar-brand {
                width:80px;
            }
            .navbar-brand img {
                width: auto;
                height: 50px;
            }
            .cart-link {
            
            }
            .search-toggle {
                margin-left: auto !important;
            }
            .hamburger-products-mega {
                position: absolute !important;
                left: 50% !important;
                top: 100% !important;
                min-width: 100% !important;
                transform: translateX(-50%) translateY(-5px) !important;
            }
            
            /* Disable hover effects on mobile/tablet */
            .dropdown-submenu:hover .hamburger-products-mega {
                display: none !important;
                opacity: 0 !important;
            }
            
            /* Only show when active class is present */
            .dropdown-submenu.active .hamburger-products-mega {
                display: block !important;
                opacity: 1 !important;
                transform: translateX(-50%) translateY(0) !important;
            }
            .hamburger-menu {
                border: none;
                margin-right: auto;
            }
        }
        
        /* Desktop hover effects */
        @media (min-width: 769px) {
            .dropdown-submenu:hover .hamburger-products-mega {
                display: block;
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* Show submenu when clicked/active */
        .dropdown-submenu.active .hamburger-products-mega {
            display: block;
            opacity: 1;
        }
        
        .hamburger-category-section {
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
            height: 100%;
        }
        
        .hamburger-category-title {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 12px;
            text-decoration: none;
            display: block;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 8px;
        }
        
        .hamburger-category-title a {
            color: var(--primary-color);
            text-decoration: none;
            display: block;
            transition: all 0.3s ease;
        }
        
        .hamburger-category-title a:hover {
            color: #e55a8a;
            transform: translateX(5px);
        }
        
        .hamburger-category-links {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .hamburger-category-links a {
            color: #666;
            text-decoration: none;
            padding: 4px 0;
            font-size: 12px;
            transition: all 0.3s ease;
            border-radius: 3px;
            display: block;
        }
        
        .hamburger-category-links a:hover {
            color: var(--primary-color);
            padding-left: 10px;
            background-color: rgba(255, 107, 157, 0.05);
            transform: translateX(5px);
        }
        
        /* Responsive styles for hamburger menu */
        @media (max-width: 768px) {
            .hamburger-dropdown {
                min-width: 320px;
                max-width: calc(100vw - 30px);
                left: 50% !important;
                transform: translateX(-50%) !important;
            }
            .dropdown-menu:not(.hamburger-dropdown) {
                min-width: 300px;
                background-color: white;
                margin-top: 5px;
            }
            
            .hamburger-products-mega {
                left: 50% !important;
                top: 100% !important;
                min-width: 350px;
                max-width: calc(100vw - 20px);
                padding: 15px;
                transform: translateX(-50%) translateY(-5px) !important;
            }
            
            .hamburger-category-section {
                padding: 10px;
                margin-bottom: 8px;
            }
            
            .hamburger-category-title {
                font-size: 16px;
                margin-bottom: 6px;
            }
            
            .hamburger-category-links a {
                font-size: 14px;
                padding: 2px 0;
            }
        }
        
        @media (max-width: 576px) {
            .hamburger-menu {
                padding: 4px 7px;
                font-size: 14px;
            }
            .dropdown-menu[data-bs-popper] {
                top: 115%;
            }

            .hamburger-dropdown {
                min-width: 350px;
                max-width: calc(100vw - 15px);
                left: 130% !important;
                transform: translateX(-50%) !important;
            }
            
            .hamburger-dropdown .dropdown-item {
                padding: 8px 12px;
                font-size: 12px;
            }
            
            .hamburger-products-mega {
                left: 50% !important;
                top: 100% !important;
                min-width: 320px;
                max-width: calc(100vw - 10px);
                padding: 0px;
                transform: translateX(-50%) translateY(-5px) !important;
            }
            
            .hamburger-products-mega .row.g-2 > .col-6 {
                flex: 0 0 100%;
                max-width: 100%;
                margin-bottom: 8px;
            }
            
            .hamburger-category-section {
                padding: 8px;
                margin-bottom: 6px;
            }
            
            .hamburger-category-title {
                font-size: 13px;
                margin-bottom: 4px;
                padding-bottom: 4px;
            }
            
            .hamburger-category-links a {
                font-size: 11px;
                padding: 1px 0;
                gap: 3px;
            }
        }
        
        /* Mega Menu Styles */
        .mega-dropdown {
            position: static !important;
            background-color: white;
            border: none;
            border-radius: 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 100%;
            left: 0 !important;
            transform: none !important;
            padding: 20px 0;
        }
        
        .mega-dropdown .container {
            max-width: 1200px;
        }
        
        .category-section {
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 10px;
            background-color: #f8f9fa;
        }
        
        .category-title {
            font-weight: bold;
            color: var(--primary-color);
            font-size: 18px;
            margin-bottom: 15px;
            text-decoration: none;
            display: block;
        }
        
        .category-title:hover {
            color: #e55a8a;
        }
        
        .category-links {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .category-links a {
            color: #666;
            text-decoration: none;
            padding: 5px 0;
            font-size: 14px;
            transition: color 0.3s ease;
        }
        
        .category-links a:hover {
            color: var(--primary-color);
        }
        
        /* Main category nav items */
        .main-nav-item {
            position: relative;
        }
        
        .main-nav-item .dropdown-toggle::after {
            display: none;
        }
        
        .btn-primary {
            background-color: #e55a8a;
            border-color: #e55a8a;
            --bs-btn-active-bg: #da487bff;
            --bs-btn-active-border-color: #da487bff;
        }   
        
        .btn-primary:hover {
            background-color: #e55a8a;
            border-color: #e55a8a;
        }
        
        .btn-secondary {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        
        .text-primary {
            color: var(--primary-color) !important;
        }
        
        .product-card {
            transition: transform 0.3s ease;
            border: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }
        
        .news-card {
            transition: transform 0.3s ease;
            border: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 15px;
            overflow: hidden;
        }
        
        .news-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }
        
        .news-card .card-img-top {
            transition: transform 0.3s ease;
        }
        
        .news-card:hover .card-img-top {
            transform: scale(1.05);
        }
        
        .btn-outline-primary {
            transition: all 0.3s ease;
        }

        .btn-outline-primary {
            --bs-btn-hover-color: #fff;
            --bs-btn-hover-bg: #e55a8a;
            --bs-btn-focus-shadow-rgb: 13, 110, 253;
            --bs-btn-active-bg: #e55a8a;
            --bs-btn-active-border-color: #e55a8a;
            --bs-btn-active-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
            --bs-btn-disabled-color: #e55a8a;
            --bs-btn-disabled-bg: transparent;
            --bs-btn-disabled-border-color: #e55a8a;
            --bs-gradient: none;
        }
        
        .btn-outline-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.3);
        }
        
        /* User menu hover effects */
        .navbar-nav .nav-link {
            position: relative;
            overflow: hidden;
        }
        
        /* Exclude cart link from hover effects */
        .navbar-nav .nav-link:not(.cart-link)::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
            z-index: 0;
            pointer-events: none;
        }
        
        .navbar-nav .nav-link:not(.cart-link):hover::before {
            left: 100%;
        }
        
        .cart-badge {
            background-color: #ff0000;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.5rem;
            position: absolute;
            top: -9px;
            right: 0px;
            transition: all 0.3s ease;
            z-index: 20 !important;
            pointer-events: none;
        }
        
        /* Cart link specific styles */
        .cart-link {
            position: relative !important;
            overflow: visible !important;
        }
        
        .cart-link:hover {
            background-color: transparent !important;
            transform: none !important;
        }
        
        .nav-link:hover .cart-badge {
            transform: scale(1.2);
            background-color: #ff3333;
        }
        
        .footer {
            background-color: var(--dark-color);
            color: white;
            padding: 3rem 0 1rem;
        }
        
        .korean-style {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4rem 0;
        }
        
        
        
        .min-vh-75 {
            min-height: 75vh;
        }
        
        .text-gradient {
            background: linear-gradient(135deg, var(--dark-color) 0%, var(--primary-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .bg-primary-soft {
            background-color: rgba(255, 107, 157, 0.1) !important;
        }    
        
        
        .floating-card-1 {
            animation: floating 3s ease-in-out infinite;
        }
        
        .floating-card-1 {
            top: 10%;
            right: -10%;
            animation-delay: 0s;
            z-index: 1;
        }
        @media (min-width: 992px) {
            .floating-card-1 {
                width : 150px;
                height: 110px;
                bottom: -20%;
                left: 85%;
                animation-delay: 1.5s;
                z-index: 1;
            }
        }

        @media (min-width: 992px) {
            .floating-card-2 {
                bottom: -27%;
                left: 35%;
                animation-delay: 1.5s;
                z-index: 1;

            }
        }

        @media (max-width: 576px) {
            .floating-card-1 {
                opacity: 0;
            }
            
            .floating-card-2 {
                bottom: -34%; !important;
                left: 75%; !important;
                animation-delay: 1.5s;
            }
        }
        
        
        
        .scroll-indicator {
            animation: bounce 2s infinite;
        }
        
        .scroll-mouse {
            width: 24px;
            height: 40px;
            border: 2px solid var(--primary-color);
            border-radius: 15px;
            position: relative;
            margin: 0 auto;
        }
        
        .scroll-wheel {
            width: 4px;
            height: 8px;
            background: var(--primary-color);
            border-radius: 2px;
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            animation: scroll-wheel 2s infinite;
        }
        
        .stat-item {
            border-radius: 10px;
            background: rgba(255, 241, 248, 0.8);
            transition: transform 0.3s ease;
        }
        
        .stat-item:hover {
            transform: translateY(-5px);
        }
        
        
        /* Animations */
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes floating {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-20px);
            }
        }
        
        @keyframes shake-bell {
            0% { transform: rotate(0deg); }
            10% { transform: rotate(15deg); }
            20% { transform: rotate(-15deg); }
            30% { transform: rotate(10deg); }
            40% { transform: rotate(-10deg); }
            50% { transform: rotate(5deg); }
            60% { transform: rotate(-5deg); }
            70%, 100% { transform: rotate(0deg); }
            }

        .shake-bell {
            animation: shake-bell 0.8s ease-in-out;
            transform-origin: top center;
        }   
        
        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }
        
        @keyframes scroll-wheel {
            0% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateX(-50%) translateY(15px);
            }
        }
        
        /* Search toggle for mobile */
        .search-toggle {
            background-color: #e55a8a;
            border: none;
            padding: 5px 12px;
            border-radius: 5px;
            color: white;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        
        .search-toggle:hover {
            background-color: #d1477a;
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(225, 90, 138, 0.3);
        }
        
        .mobile-search-container {
            background-color: var(--primary-color);
            border-top: 0px solid var(--primary-color);
            padding: 10px 5px;
            display: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            position: fixed;
            top: 50px; /* Chiều cao của navbar */
            left: 0;
            right: 0;
            z-index: 1000;
            width: 100%;
            transition: transform 0.3s ease-in-out;
            will-change: transform;
        }
        
        .mobile-search-container.nav-up {
            transform: translateY(-100%);
        }
        
        .mobile-search-container.show {
            display: block !important;
            animation: slideDown 0.3s ease;
        }
        
        .mobile-search-container .form-control {
            height: 40px;
            border-radius: 4px 0 0 4px;
            border: none;
        }
        
        .mobile-search-container .btn {
            border-radius: 0 4px 4px 0;
        }
        
        /* Thêm padding-top cho main content để tránh bị che khi search hiển thị */
        main {
            padding-top: 60px;
        }
        
        .form-control:focus {
            box-shadow: none;
            border-color: #ff0000ff;
        }

        @media (min-width: 768px) {
            .mobile-search-container {
                top: 70px; /* Chiều cao của navbar */
            }
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Hide desktop search on mobile */
        @media (max-width: 1200px) {
            .desktop-search {
                display: none !important;
            }
            
            .search-toggle {
                display: inline-block;
            }
        }
        
        @media (min-width: 1201px) {
            .search-toggle {
                display: none;
            }
            
            .mobile-search-container {
                display: none !important;
            }
        }

        @media (max-width: 991px) {
            .scroll-indicator {
                display: none;
            }
            
            .mobile-user-avatar {
                width: 30px;
                height:30px;
                border-radius: 50%;
                margin-right: 10px;
                background: #4ecdc4;
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                font-size: 16px;
                margin-left: 10px;
                text-decoration: none;
                border: 2px solid white;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            }

            .mobile-user-menu {
                min-width: 200px;
                padding: 8px 0;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }
        }
    </style>
    
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
        <div class="container">
            <a class="navbar-brand p-0 m-0" href="{% url 'customer_web:home' %}">
                <img src="{% static 'customer_web/images/logo.jpg' %}" alt="KiKi Logo" class="d-inline-block" style="margin: 0; padding: 0;">
            </a>
            <!-- Hamburger Menu Button -->
            <div class="dropdown">
                <button class="hamburger-menu" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fas fa-bars me-2"></i>Menu
                </button>
                <ul class="dropdown-menu hamburger-dropdown">
                    <li><a class="dropdown-item" href="{% url 'customer_web:home' %}">
                        <i class="fas fa-home me-2"></i>Trang chủ
                    </a></li>
                    
                    <!-- Tất cả sản phẩm với submenu -->
                    <li class="dropdown-submenu">
                        <a class="dropdown-item dropdown-toggle">
                            <i class="fas fa-shopping-bag me-2"></i>Tất cả sản phẩm
                        </a>
                        <div class="dropdown-menu hamburger-products-mega">
                            <div class="hamburger-mega-container">
                                <div class="row">
                                    <!-- Quần áo bé gái -->
                                    <div class="col-6 col-md-3">
                                        <div class="hamburger-category-section">
                                            <h6 class="hamburger-category-title">
                                                <a href="{% url 'customer_web:product_list' %}?categories=quan-ao-be-gai">
                                                    <i class="fas fa-female me-2"></i>Quần áo bé gái
                                                </a>
                                            </h6>
                                            <div class="hamburger-category-links">
                                                <a href="{% url 'customer_web:product_list' %}?categories=do-bo-be-gai">Đồ bộ bé gái</a>
                                                <a href="{% url 'customer_web:product_list' %}?categories=vay-dam-be-gai">Váy đầm bé gái</a>
                                                <a href="{% url 'customer_web:product_list' %}?categories=ao-be-gai">Áo bé gái</a>
                                                <a href="{% url 'customer_web:product_list' %}?categories=quan-be-gai">Quần bé gái</a>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Quần áo bé trai -->
                                    <div class="col-6 col-md-3">
                                        <div class="hamburger-category-section">
                                            <h6 class="hamburger-category-title">
                                                <a href="{% url 'customer_web:product_list' %}?categories=quan-ao-be-trai">
                                                    <i class="fas fa-male me-2"></i>Quần áo bé trai
                                                </a>
                                            </h6>
                                            <div class="hamburger-category-links">
                                                <a href="{% url 'customer_web:product_list' %}?categories=do-bo-be-trai">Đồ bộ bé trai</a>
                                                <a href="{% url 'customer_web:product_list' %}?categories=ao-be-trai">Áo bé trai</a>
                                                <a href="{% url 'customer_web:product_list' %}?categories=quan-be-trai">Quần bé trai</a>
                                                <a href="{% url 'customer_web:product_list' %}?categories=do-boi-be-trai">Đồ bơi bé trai</a>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Phụ kiện -->
                                    <div class="col-6 col-md-3">
                                        <div class="hamburger-category-section">
                                            <h6 class="hamburger-category-title">
                                                <a href="{% url 'customer_web:product_list' %}?categories=phu-kien">
                                                    <i class="fas fa-gem me-2"></i>Phụ kiện
                                                </a>
                                            </h6>
                                            <div class="hamburger-category-links">
                                                <a href="{% url 'customer_web:product_list' %}?categories=giay-dep-be-gai">Giày dép bé gái</a>
                                                <a href="{% url 'customer_web:product_list' %}?categories=giay-dep-cho-be-trai">Giày dép bé trai</a>
                                                <a href="{% url 'customer_web:product_list' %}?categories=non-mu-cho-be">Nón mũ cho bé</a>
                                                <a href="{% url 'customer_web:product_list' %}?categories=ba-lo-tui-deo">Ba lô túi đeo</a>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Quần áo sơ sinh -->
                                    <div class="col-6 col-md-3">
                                        <div class="hamburger-category-section">
                                            <h6 class="hamburger-category-title">
                                                <a href="{% url 'customer_web:product_list' %}?categories=quan-ao-so-sinh">
                                                    <i class="fas fa-baby me-2"></i>Quần áo sơ sinh
                                                </a>
                                            </h6>
                                            <div class="hamburger-category-links">
                                                <a href="{% url 'customer_web:product_list' %}?categories=body-ao-lien-quan">Body áo liền quần</a>
                                                <a href="{% url 'customer_web:product_list' %}?categories=do-bo-so-sinh">Đồ bộ sơ sinh</a>
                                                <a href="{% url 'customer_web:product_list' %}?categories=ao-so-sinh">Phụ kiện sơ sinh</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    
                    <li><a class="dropdown-item" href="{% url 'customer_web:news_list' %}">
                        <i class="fas fa-blog me-2"></i>Blog
                    </a></li>
                    <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?hot_trend=true">
                        <i class="fas fa-fire me-2"></i>Hot Trend
                    </a></li>
                </ul>
            </div>
            
            <!-- Mobile Search Toggle Button -->
            <button class="search-toggle" type="button">
                <i class="fas fa-search"></i>
            </button>

               
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <!-- Quần áo bé gái -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            Quần áo bé gái
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=do-bo-be-gai">
                                <i class="fas fa-tshirt me-2"></i>Đồ bộ bé gái
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=vay-dam-be-gai">
                                <i class="fas fa-dress me-2"></i>Váy đầm bé gái
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=ao-be-gai">
                                <i class="fas fa-baby me-2"></i>Áo bé gái
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=quan-be-gai">
                                <i class="fas fa-child me-2"></i>Quần bé gái
                            </a></li>
                        </ul>
                    </li>

                    <!-- Quần áo bé trai -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            Quần áo bé trai
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=do-bo-be-trai">
                                <i class="fas fa-tshirt me-2"></i>Đồ bộ bé trai
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=ao-be-trai">
                                <i class="fas fa-baby me-2"></i>Áo bé trai
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=quan-be-trai">
                                <i class="fas fa-child me-2"></i>Quần bé trai
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=do-boi-be-trai">
                                <i class="fas fa-swimmer me-2"></i>Đồ bơi bé trai
                            </a></li>
                        </ul>
                    </li>

                    <!-- Phụ kiện -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            Phụ kiện
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=giay-dep-be-gai">
                                <i class="fas fa-shoe-prints me-2"></i>Giày dép bé gái
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=giay-dep-cho-be-trai">
                                <i class="fas fa-shoe-prints me-2"></i>Giày dép bé trai
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=non-mu-cho-be">
                                <i class="fas fa-hat-cowboy me-2"></i>Nón mũ cho bé
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=ba-lo-tui-deo">
                                <i class="fas fa-backpack me-2"></i>Ba lô túi đeo
                            </a></li>
                        </ul>
                    </li>

                    <!-- Quần áo sơ sinh -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            Quần áo sơ sinh
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=body-ao-lien-quan">
                                <i class="fas fa-baby me-2"></i>Body áo liền quần
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=do-bo-so-sinh">
                                <i class="fas fa-baby me-2"></i>Đồ bộ sơ sinh
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:product_list' %}?categories=ao-so-sinh">
                                <i class="fas fa-baby-carriage me-2"></i>Phụ kiện sơ sinh
                            </a></li>
                        </ul>
                    </li>
                </ul>
                
                <!-- Search -->
                <form class="d-flex me-3 desktop-search" method="GET" action="{% url 'customer_web:product_list' %}">
                    <input class="form-control me-2" type="search" name="search" placeholder="Nhập tên..." value="{{ request.GET.search }}"required>
                    <button class="btn btn-outline-primary" type="submit">
                        <i class="fas fa-search"></i>
                    </button>
                </form>
                <!-- User menu -->
                <ul class="navbar-nav">
                    {% if user.is_authenticated %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user"></i> {{ user.first_name|default:user.username }}
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{% url 'customer_web:profile' %}">Hồ sơ</a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:order_history' %}">Đơn hàng</a></li>
                            <li><a class="dropdown-item" href="{% url 'customer_web:logout' %}">Đăng xuất</a></li>
                        </ul>
                    </li>
                    {% endif %}
                </ul>
            </div>
              <!-- Cart Icon - Always visible -->
            <a class="nav-link position-relative cart-link d-flex" href="{% url 'customer_web:cart' %}">
                <i class="fas fa-shopping-cart"></i>
                <span id="cart-badge" class="cart-badge">{{ cart_total_items }}</span>
            </a>

            
            <!-- Mobile User Avatar -->
            {% if user.is_authenticated %}
            <div class="dropdown d-lg-none">
                <a href="#" class="mobile-user-avatar dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    {{ user.first_name|default:user.username|make_list|first|upper }}
                </a>
                <ul class="dropdown-menu dropdown-menu-end mobile-user-menu">
                    <li><a class="dropdown-item" href="{% url 'customer_web:profile' %}">
                        <i class="fas fa-user me-2"></i>Hồ sơ
                    </a></li>
                    <li><a class="dropdown-item" href="{% url 'customer_web:order_history' %}">
                        <i class="fas fa-shopping-bag me-2"></i>Đơn hàng
                    </a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="{% url 'customer_web:logout' %}">
                        <i class="fas fa-sign-out-alt me-2"></i>Đăng xuất
                    </a></li>
                </ul>
            </div>
        {% else %}
            <div class="d-flex align-items-center">
                <div class="dropdown">
                    <button type="button" class="btn btn-link nav-link dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-user-circle fs-5"></i>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end mobile-user-menu">
                        <li><a class="dropdown-item" href="{% url 'customer_web:login' %}">
                            <i class="fas fa-sign-in-alt me-2"></i>Đăng nhập
                        </a></li>
                        <li><a class="dropdown-item" href="{% url 'customer_web:register' %}">
                            <i class="fas fa-user-plus me-2"></i>Đăng ký
                        </a></li>
                    </ul>
                </div>
            </div>
        {% endif %}



        </div>
    </nav>

    <!-- Messages -->
    {% if messages %}
    <div class="container mt-3">
        {% for message in messages %}
            {% if 'đăng nhập thành công' not in message|lower and 'đăng xuất thành công' not in message|lower and 'login successful' not in message|lower and 'logout successful' not in message|lower %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            {% endif %}
        {% endfor %}
    </div>
    {% endif %}

    <!-- Mobile Search Container -->
    <div class="mobile-search-container" id="mobileSearchContainer">
        <div class="container">
            <form method="GET" action="{% url 'customer_web:product_list' %}">
                <div class="input-group">
                    <input class="form-control" type="search" name="search" placeholder="Tìm kiếm sản phẩm..." value="{{ request.GET.search }}" required>
                    <button class="btn btn-primary" type="submit">
                        <i class="fas fa-search me-1"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Main content -->
    <main>
        {% block content %}
        {% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5>KiKi</h5>
                    <p>Thời trang Hàn Quốc chất lượng cao cho giới trẻ. Phong cách hiện đại, trendy và đầy cá tính.</p>
                    <div class="social-links">
                        <a href="#" class="text-white me-3"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-tiktok"></i></a>
                    </div>
                </div>
                <div class="col-md-4">
                    <h5>Liên hệ</h5>
                    <p><i class="fas fa-phone"></i> 0123 456 789</p>
                    <p><i class="fas fa-envelope"></i> info@kiki.com</p>
                    <p><i class="fas fa-map-marker-alt"></i> 123 Đường ABC, Quận 1, TP.HCM</p>
                </div>
                <div class="col-md-4">
                    <h5>Chính sách</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white-50">Chính sách đổi trả</a></li>
                        <li><a href="#" class="text-white-50">Chính sách bảo mật</a></li>
                        <li><a href="#" class="text-white-50">Điều khoản sử dụng</a></li>
                        <li><a href="#" class="text-white-50">Hướng dẫn mua hàng</a></li>
                    </ul>
                </div>
            </div>
            <hr class="border-white-50">
            <div class="text-center">
                <p>&copy; 2025 KiKi. All rights reserved.</p>
            </div>
        </div>
    </footer>

   <!-- Bootstrap 5 JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // Helper: Get CSRF Token
    function getCookie(name) {
        const cookies = document.cookie.split(';').map(c => c.trim());
        for (let cookie of cookies) {
            if (cookie.startsWith(name + '=')) {
                return decodeURIComponent(cookie.split('=')[1]);
            }
        }
        return null;
    }

    // Show Bootstrap-like Alert
    function showAlert(type, message) {
        const container = document.querySelector('.container');
        if (!container) return;

        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type} alert-dismissible fade show mt-2`;
        alertDiv.innerHTML = `
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        container.insertBefore(alertDiv, container.firstChild);

        setTimeout(() => alertDiv.remove(), 5000);
    }

    // Add to Cart
    function addToCart(productId, size = '', color = '', quantity = 1) {
        fetch('{% url "customer_web:add_to_cart" %}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({ product_id: productId, size, color, quantity })
        })
        .then(res => res.json())
        .then(data => {
            if (data.success) {
                // Update cart badge visually
                document.getElementById('cart-badge').textContent = data.cart_total;
                showAlert('success', data.message);
            } else {
                showAlert('danger', data.message);
            }
        })
        .catch(() => showAlert('danger', 'Có lỗi xảy ra!'));
    }
    window.addEventListener('pageshow', function (event) {
        // Khi user quay lại trang bằng nút back, hoặc forward
        if (event.persisted || (window.performance && window.performance.navigation.type === 2)) {
            // Gọi AJAX để cập nhật icon giỏ hàng
            fetchCartTotal();
        }
    });

    // Hàm fetchCartTotal để lấy lại số lượng giỏ hàng
    function fetchCartTotal() {
        fetch('{% url "customer_web:get_cart_total" %}')
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('cart-badge').textContent = data.cart_total;
                }
            });
    }


    // Toggle Mobile Search Function
    function toggleMobileSearch() {
        console.log('toggleMobileSearch called'); // Debug log
        const searchContainer = document.getElementById('mobileSearchContainer');
        console.log('searchContainer:', searchContainer); // Debug log
        if (searchContainer) {
            searchContainer.classList.toggle('show');
            console.log('Has show class:', searchContainer.classList.contains('show')); // Debug log
            if (searchContainer.classList.contains('show')) {
                const input = searchContainer.querySelector('input[type="search"]');
                if (input) setTimeout(() => input.focus(), 300);
            }
        }
    }

    let lastScrollTop = 0;
    const navbar = document.querySelector('.navbar');
    const mobileSearchContainer = document.getElementById('mobileSearchContainer');
    const delta = 5;
    let didScroll = false;

    window.addEventListener('scroll', function() {
        didScroll = true;
    });

    // Run hasScrolled() every 250ms
    setInterval(function() {
        if (didScroll) {
            hasScrolled();
            didScroll = false;
        }
    }, 250);

    function hasScrolled() {
        const st = window.pageYOffset || document.documentElement.scrollTop;
        
        // Make sure they scroll more than delta
        if(Math.abs(lastScrollTop - st) <= delta)
            return;
        
        // If they scrolled down and are past the navbar, add class nav-up
        if (st > lastScrollTop && st > 50) {
            // Scroll Down
            navbar.classList.add('nav-up');
            if (mobileSearchContainer && mobileSearchContainer.classList.contains('show')) {
                mobileSearchContainer.classList.add('nav-up');
            }
        } else {
            // Scroll Up
            if(st + window.innerHeight < document.documentElement.scrollHeight) {
                navbar.classList.remove('nav-up');
                if (mobileSearchContainer && mobileSearchContainer.classList.contains('show')) {
                    mobileSearchContainer.classList.remove('nav-up');
                }
            }
        }
        
        lastScrollTop = st;
    }

    document.addEventListener('DOMContentLoaded', function () {
        // Ensure cart badge is always visible and correct on page load
        var cartBadge = document.getElementById('cart-badge');
        if (cartBadge && typeof {{ cart_total_items|default:0 }} !== 'undefined') {
            cartBadge.textContent = {{ cart_total_items|default:0 }};
        }
        // Initialize Bootstrap dropdowns
        const dropdownElements = document.querySelectorAll('[data-bs-toggle="dropdown"]');
        dropdownElements.forEach(el => {
            new bootstrap.Dropdown(el);
        });

        // Handle dropdown toggles for mobile/tablet
        function handleDropdownToggle() {
            const dropdownToggles = document.querySelectorAll('.nav-item.dropdown .nav-link.dropdown-toggle');
            
            dropdownToggles.forEach(toggle => {
                // Remove any existing event listeners
                toggle.replaceWith(toggle.cloneNode(true));
            });
            
            // Re-select after cloning
            const newDropdownToggles = document.querySelectorAll('.nav-item.dropdown .nav-link.dropdown-toggle');
            
            newDropdownToggles.forEach(toggle => {
                toggle.addEventListener('click', function(e) {
                    // Only handle clicks on mobile/tablet (screen width < 992px)
                    if (window.innerWidth < 992) {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        const dropdownMenu = this.nextElementSibling;
                        const parentDropdown = this.closest('.nav-item.dropdown');
                        
                        // Close all other dropdowns
                        document.querySelectorAll('.nav-item.dropdown .dropdown-menu').forEach(menu => {
                            if (menu !== dropdownMenu) {
                                menu.classList.remove('show');
                                menu.previousElementSibling.setAttribute('aria-expanded', 'false');
                            }
                        });
                        
                        // Toggle current dropdown
                        const isOpen = dropdownMenu.classList.contains('show');
                        
                        if (isOpen) {
                            dropdownMenu.classList.remove('show');
                            this.setAttribute('aria-expanded', 'false');
                        } else {
                            dropdownMenu.classList.add('show');
                            this.setAttribute('aria-expanded', 'true');
                        }
                    }
                });
            });
        }
        
        // Initialize dropdown handling
        handleDropdownToggle();
        
        // Re-initialize when window is resized
        window.addEventListener('resize', handleDropdownToggle);
        
        // Close dropdowns when clicking outside (mobile/tablet only)
        document.addEventListener('click', function(e) {
            if (window.innerWidth < 992) {
                if (!e.target.closest('.nav-item.dropdown')) {
                    document.querySelectorAll('.nav-item.dropdown .dropdown-menu.show').forEach(menu => {
                        menu.classList.remove('show');
                        menu.previousElementSibling.setAttribute('aria-expanded', 'false');
                    });
                }
            }
        });

        // Mobile Search functionality
        const mobileSearchToggle = document.querySelector('.search-toggle');
        const searchContainer = document.getElementById('mobileSearchContainer');

        if (mobileSearchToggle && searchContainer) {
            // Toggle search when clicking search button
            mobileSearchToggle.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                toggleMobileSearch();
            });

            // Close search when clicking outside
            document.addEventListener('click', function(e) {
                if (!searchContainer.contains(e.target) && !mobileSearchToggle.contains(e.target)) {
                    searchContainer.classList.remove('show');
                }
            });
        }

        // Hamburger submenu functionality
        const submenuToggle = document.querySelector('.dropdown-submenu .dropdown-toggle');
        const submenuMega = document.querySelector('.hamburger-products-mega');
        const submenuParent = document.querySelector('.dropdown-submenu');

        if (submenuToggle && submenuMega && submenuParent) {
            submenuToggle.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                // Chỉ xử lý toggle trên mobile/tablet (max-width: 991px)
                if (window.innerWidth <= 991) {
                    if (submenuParent.classList.contains('active')) {
                        submenuParent.classList.remove('active');
                    } else {
                        submenuParent.classList.add('active');
                    }
                }
            });
            // Desktop hover giữ nguyên
            submenuParent.addEventListener('mouseenter', function() {
                if (window.innerWidth > 991) {
                    this.classList.add('active');
                }
            });
            submenuParent.addEventListener('mouseleave', function() {
                if (window.innerWidth > 991) {
                    this.classList.remove('active');
                }
            });
        }

        // Close submenu when clicking outside
        document.addEventListener('click', function(e) {
            if (submenuParent && !e.target.closest('.dropdown-submenu')) {
                submenuParent.classList.remove('active');
            }
        });
        
        // Close hamburger menu when clicking on category links
        const categoryLinks = document.querySelectorAll('.hamburger-category-links a, .hamburger-category-title a');
        categoryLinks.forEach(link => {
            link.addEventListener('click', function() {
                // Close the hamburger dropdown
                const hamburgerDropdown = document.querySelector('.hamburger-dropdown');
                const hamburgerButton = document.querySelector('.hamburger-menu');
                if (hamburgerDropdown && hamburgerButton) {
                    hamburgerDropdown.classList.remove('show');
                    hamburgerButton.setAttribute('aria-expanded', 'false');
                }
                
                // Close the submenu
                if (submenuParent) {
                    submenuParent.classList.remove('active');
                }
            });
        });
    });
    const saleCard = document.querySelector('.floating-card-2');

    setInterval(() => {
        saleCard.classList.add('shake-bell');
        setTimeout(() => {
        saleCard.classList.remove('shake-bell');
        }, 800); // bằng thời gian animation
    }, 3000); // rung mỗi 3 giây
</script>

{% block extra_js %}{% endblock %}
</body>
</html>